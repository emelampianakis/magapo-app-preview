"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1672],{1672:(U,f,s)=>{s.r(f),s.d(f,{VoucherPageModule:()=>b});var v=s(177),D=s(4341),r=s(4488),C=s(8986),h=s(467),E=s(5083);const l=(0,E.F3)("BarcodeScanner",{web:()=>s.e(870).then(s.bind(s,870)).then(t=>new t.BarcodeScannerWeb)});var d=s(8254),e=s(4438);function P(t,c){1&t&&(e.j41(0,"div",10)(1,"div",11)(2,"div",12),e.nrm(3,"img",13),e.k0s(),e.j41(4,"span",14),e.EFF(5,"\u0394\u03ad\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03b5\u03b9 \u03b1\u03c0\u03bf\u03b8\u03b7\u03ba\u03b5\u03c5\u03bc\u03ad\u03bd\u03bf \u03ba\u03bf\u03c5\u03c0\u03cc\u03bd\u03b9"),e.k0s(),e.j41(6,"span"),e.EFF(7,"\u0391\u03c6\u03bf\u03cd \u03c3\u03ba\u03b1\u03bd\u03ac\u03c1\u03b5\u03c4\u03b5 \u03c4\u03bf QR, \u03b5\u03b4\u03ce \u03b8\u03b1 \u03b2\u03c1\u03b5\u03af\u03c4\u03b5 \u03c4\u03bf \u03b1\u03c0\u03bf\u03b8\u03b7\u03ba\u03b5\u03c5\u03bc\u03ad\u03bd\u03bf \u03c3\u03b1\u03c2 \u03ba\u03bf\u03c5\u03c0\u03cc\u03bd\u03b9"),e.k0s()()())}function y(t,c){if(1&t&&(e.j41(0,"ion-card-subtitle"),e.EFF(1),e.k0s()),2&t){const u=e.XpG(2);e.R7$(),e.JRh(u.voucher.voucherCode)}}function R(t,c){if(1&t){const u=e.RV6();e.j41(0,"ion-card",15)(1,"ion-button",16),e.bIt("click",function(){e.eBV(u);const i=e.XpG();return e.Njj(i.removeVoucher())}),e.nrm(2,"ion-icon",17),e.k0s(),e.j41(3,"ion-card-header")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.DNE(6,y,2,1,"ion-card-subtitle",18),e.k0s(),e.j41(7,"ion-card-content")(8,"div",19)(9,"b"),e.EFF(10),e.k0s()(),e.j41(11,"div",20)(12,"div")(13,"b"),e.EFF(14,"Valid from:"),e.k0s()(),e.j41(15,"div"),e.EFF(16),e.nI1(17,"date"),e.k0s()(),e.j41(18,"div",20)(19,"div")(20,"b"),e.EFF(21,"Expires:"),e.k0s()(),e.j41(22,"div"),e.EFF(23),e.nI1(24,"date"),e.k0s()()()()}if(2&t){const u=e.XpG();e.R7$(5),e.JRh(u.voucher.title),e.R7$(),e.Y8G("ngIf",u.voucher.voucherCode),e.R7$(4),e.JRh(u.voucher.description),e.R7$(6),e.JRh(e.i5U(17,5,null==u.voucher?null:u.voucher.startDate,"EEE dd/MM/yyyy")),e.R7$(7),e.JRh(e.i5U(24,8,null==u.voucher?null:u.voucher.endDate," EEE dd/MM/yyyy"))}}const p="voucher",O=[{path:"",component:(()=>{var t;class c{constructor(n){this.alertController=n,this.isSupported=!1}ngOnInit(){var n=this;return(0,h.A)(function*(){n.checkScannerSupport();const i=yield d.p.get({key:p});i&&i.value?(n.voucher=JSON.parse(i.value),n.checkExpiration(n.voucher.endDate)?(yield d.p.remove({key:p}),n.voucher=null,console.log("Voucher expired and removed"),n.presentAlert("Expired Voucher","The stored voucher has expired.")):console.log(i.value)):(n.voucher=null,console.log("No voucher found"))})()}checkScannerSupport(){E.Ii.isNativePlatform()?l.isSupported().then(n=>{this.isSupported=n.supported,n.supported&&l.isGoogleBarcodeScannerModuleAvailable().then(function(){var i=(0,h.A)(function*(o){o.available||(yield l.installGoogleBarcodeScannerModule())});return function(o){return i.apply(this,arguments)}}())}):this.isSupported=!1}scan(){var n=this;return(0,h.A)(function*(){if(!(yield n.requestPermissions()))return void n.presentAlert("Permission denied","Please grant camera permission to use the barcode scanner.");const{barcodes:o}=yield l.scan();o&&o[0].rawValue.startsWith("##magapoapp##")?n.setVoucher(o[0].rawValue):n.presentAlert("Invalid QR","Please scan a valid QR code.")})()}requestPermissions(){return(0,h.A)(function*(){const{camera:n}=yield l.requestPermissions();return"granted"===n||"limited"===n})()}presentAlert(n,i){var o=this;return(0,h.A)(function*(){yield(yield o.alertController.create({header:n,message:i,buttons:["OK"]})).present()})()}checkExpiration(n){return new Date>new Date(n)}setVoucher(n){var i=this;return(0,h.A)(function*(){let o=n;o=o.replace("##magapoapp##","");let a={};o.split(";").forEach(V=>{let[I,j]=V.split(":");a[I]=j});let x=new Date(a.StartDate),k=new Date(a.EndDate);i.checkExpiration(a.EndDate)?i.presentAlert("Expired Voucher","The scanned voucher has expired."):(i.voucher={title:a.Title,description:a.Description,startDate:x,endDate:k,voucherCode:a.VoucherCode},yield d.p.set({key:p,value:JSON.stringify(i.voucher)}))})()}removeVoucher(){var n=this;return(0,h.A)(function*(){yield d.p.remove({key:p}),n.voucher=null})()}}return(t=c).\u0275fac=function(n){return new(n||t)(e.rXU(r.hG))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-voucher"]],decls:13,vars:5,consts:[[3,"translucent"],["slot","start"],["text","","defaultHref","/"],[3,"fullscreen"],[2,"display","flex","flex-direction","column","justify-content","center","align-items","center","height","100%"],["class","empty-page-placeholder",4,"ngIf"],["color","primary","mode","ios",4,"ngIf"],["slot","fixed","vertical","bottom","horizontal","end"],["color","primary",3,"click","disabled"],["name","scan-outline"],[1,"empty-page-placeholder"],[1,"empty-page-info-container",2,"display","flex","flex-direction","column"],[1,"image-container"],["src","assets/noResults.svg","alt","Your SVG Image"],[2,"font-size","20px","font-weight","700","padding-bottom","16px"],["color","primary","mode","ios"],["fill","clear","color","light",2,"position","absolute","right","0","z-index","99",3,"click"],["slot","icon-only","name","close-outline"],[4,"ngIf"],[2,"padding","16px 0"],[2,"display","flex","justify-content","space-between"]],template:function(n,i){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Voucher"),e.k0s()()(),e.j41(6,"ion-content",3)(7,"div",4),e.DNE(8,P,8,0,"div",5)(9,R,25,11,"ion-card",6),e.k0s(),e.j41(10,"ion-fab",7)(11,"ion-fab-button",8),e.bIt("click",function(){return i.scan()}),e.nrm(12,"ion-icon",9),e.k0s()()()),2&n&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("ngIf",!i.voucher),e.R7$(),e.Y8G("ngIf",i.voucher),e.R7$(2),e.Y8G("disabled",!i.isSupported))},dependencies:[v.bT,r.Jm,r.QW,r.b_,r.I9,r.ME,r.HW,r.tN,r.W9,r.Q8,r.YW,r.eU,r.iq,r.BC,r.ai,r.el,v.vh],styles:["ion-card[_ngcontent-%COMP%]{width:80%}"]}),c})()}];let F=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[C.iI.forChild(O),C.iI]}),c})(),b=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[v.MD,D.YN,r.bv,F]}),c})()}}]);